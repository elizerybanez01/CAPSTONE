<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Accounts</title>
<link rel="stylesheet" href="dashboard.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  /* Account-specific styling */
  .main-content {
    padding: 24px;
    background-color: #ACC9DB;
  }
  
  .main-content h1 {
    color: #2c3e50;
    margin-bottom: 28px;
    font-weight: 700;
    font-size: 32px;
    padding-bottom: 12px;
    border-bottom: 1px solid #eaeaea;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  
  .main-content h1 i {
    color: #3498db;
    font-size: 28px;
  }
  
  .account-tabs {
    display: flex;
    margin-bottom: 24px;
    background-color: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    padding: 6px;
    width: fit-content;
    border: 1px solid #eaeaea;
  }
  
  .account-tabs button {
    padding: 12px 28px;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 16px;
    font-weight: 500;
    color: #64748b;
    position: relative;
    transition: all 0.3s ease;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .account-tabs button i {
    font-size: 18px;
  }
  
  .account-tabs button.active {
    color: #3498db;
    font-weight: 600;
    background-color: #eef7ff;
    box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
  }
  
  .account-tabs button:hover:not(.active) {
    color: #3498db;
    background-color: #f8f9fa;
  }
  
  /* Table container for better card effect */
  .table-container {
    background-color: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    overflow: hidden;
    margin-bottom: 24px;
  }
  
  /* Table styling */
  #accountsTable {
    width: 100%;
    border-collapse: collapse;
  }
  
  #accountsTable thead {
    background-color: #f1f5f9;
  }
  
  #accountsTable th {
    padding: 18px 16px;
    text-align: left;
    font-weight: 600;
    color: #334155;
    border-bottom: 2px solid #e2e8f0;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }
  
  #accountsTable td {
    padding: 16px;
    border-bottom: 1px solid #e2e8f0;
    color: #475569;
    font-size: 14px;
  }
  
  #accountsTable tr:last-child td {
    border-bottom: none;
  }
  
  #accountsTable tr {
    transition: background-color 0.2s ease;
  }
  
  #accountsTable tr:hover {
    background-color: #f8fafc;
  }
  
  /* Block/Lot link styling */
  .block-lot-link {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #3498db;
    text-decoration: none;
    font-weight: 600;
    cursor: pointer;
    transition: color 0.2s;
  }
  
  .block-lot-link:hover {
    color: #2980b9;
    text-decoration: underline;
  }
  
  /* Button styling */
  #accountsTable button {
    padding: 8px 16px;
    margin: 0 4px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 6px;
  }
  
  /* View buttons (Vehicles, Pets, Members) */
  #accountsTable td:nth-child(3) button {
    background-color: #f1f5f9;
    color: #475569;
    border: 1px solid #e2e8f0;
  }
  
  #accountsTable td:nth-child(3) button:hover {
    background-color: #e2e8f0;
    transform: translateY(-1px);
  }
  
  /* Action buttons (Approve, Decline) */
  #accountsTable td:nth-child(7) button:first-child {
    background-color: #10b981;
    color: white;
    box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
  }
  
  #accountsTable td:nth-child(7) button:first-child:hover {
    background-color: #059669;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(16, 185, 129, 0.4);
  }
  
  #accountsTable td:nth-child(7) button:last-child {
    background-color: #ef4444;
    color: white;
    box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
  }
  
  #accountsTable td:nth-child(7) button:last-child:hover {
    background-color: #dc2626;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(239, 68, 68, 0.4);
  }
  
  /* Status badges */
  .status-pending {
    color: #f59e0b !important;
  }
  
  .status-approved {
    color: #10b981 !important;
  }
  
  .status-declined {
    color: #ef4444 !important;
  }
  
  /* Modal styling */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
    animation: fadeIn 0.3s ease;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  .modal-content {
    background-color: #fff;
    padding: 28px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    width: 90%;
    max-width: 650px;
    max-height: 80vh;
    overflow-y: auto;
    animation: slideIn 0.3s ease;
    position: relative;
  }
  
  @keyframes slideIn {
    from { transform: translateY(-20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }
  
  .modal-content h3 {
    margin-top: 0;
    color: #2c3e50;
    border-bottom: 1px solid #e9ecef;
    padding-bottom: 16px;
    font-size: 22px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .modal-content h3 i {
    color: #3498db;
  }
  
  .detail-item {
    margin-bottom: 18px;
    padding-bottom: 18px;
    border-bottom: 1px solid #f1f3f4;
    transition: background-color 0.2s;
    border-radius: 6px;
    padding: 12px;
  }
  
  .detail-item:hover {
    background-color: #f8fafc;
  }
  
  .detail-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
  }
  
  .detail-item p {
    margin: 8px 0;
    display: flex;
  }
  
  .detail-item b {
    min-width: 140px;
    color: #475569;
  }
  
  .detail-item hr {
    margin-top: 12px;
    border: none;
    border-top: 1px solid #e9ecef;
  }
  
  .modal-content .btn {
    margin-top: 16px;
    padding: 10px 22px;
    background-color: #3498db;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 500;
    transition: all 0.2s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }
  
  .modal-content .btn:hover {
    background-color: #2980b9;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
  }
  
  /* Empty state styling */
  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: #64748b;
  }
  
  .empty-state i {
    font-size: 48px;
    margin-bottom: 16px;
    color: #cbd5e1;
  }
  
  .empty-state p {
    font-size: 18px;
    margin-bottom: 8px;
  }
  
  .empty-state .subtext {
    font-size: 14px;
    color: #94a3b8;
  }
  
  /* Loading animation */
  @keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
  }
  
  .loading-row {
    animation: pulse 1.5s infinite;
  }
  
  .loading-row td {
    padding: 24px 16px;
  }
  
  .loading-placeholder {
    height: 12px;
    background-color: #e2e8f0;
    border-radius: 4px;
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .main-content {
      padding: 16px;
    }
    
    .account-tabs {
      flex-direction: column;
      width: 100%;
    }
    
    .account-tabs button {
      width: 100%;
      text-align: center;
      justify-content: center;
    }
    
    .table-container {
      border-radius: 8px;
      overflow-x: auto;
    }
    
    #accountsTable {
      min-width: 700px;
    }
    
    .modal-content {
      width: 95%;
      padding: 20px;
      margin: 20px;
    }
    
    #accountsTable button {
      padding: 6px 10px;
      font-size: 12px;
    }
  }
</style>
</head>
<body>
<div class="container">
  <nav class="sidebar">
    <div class="logo">Evissa</div>
    <ul class="nav-links">
      <li><a href="dashboard.html"><i class="fas fa-house"></i> Dashboard</a></li>
      <li><a href="reservation.html"><i class="fas fa-calendar-alt"></i> Reservations</a></li>
      <li><a href="dues.html"><i class="fas fa-circle-check"></i> Dues</a></li>
      <li><a href="laborers.html"><i class="fas fa-briefcase"></i> Laborers</a></li>
      <li><a href="messages.html"><i class="fas fa-comments"></i> Messages</a></li>
      <li><a href="accounts.html" class="active"><i class="fas fa-users"></i> Accounts</a></li>
      <li><a href="hoa.html"><i class="fas fa-sitemap"></i> HOA Officers</a></li>
    </ul>
  </nav>

  <main class="main-content">
    <h1><i class="fas fa-users"></i> Account Management</h1>

    <div class="account-tabs">
      <button id="accountsBtn" class="active"><i class="fas fa-check-circle"></i> Approved Accounts</button>
      <button id="pendingBtn"><i class="fas fa-clock"></i> Pending Approval</button>
    </div>

    <div class="table-container">
      <table id="accountsTable">
        <thead>
          <tr id="tableHeadRow"></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </main>
</div>

<!-- Vehicle Details Modal -->
<div id="vehicleModal" class="modal">
  <div class="modal-content">
    <h3><i class="fas fa-car"></i> Vehicle Details</h3>
    <div id="vehicleDetails"></div>
    <button class="btn close-vehicle"><i class="fas fa-times"></i> Close</button>
  </div>
</div>

<!-- Pet Details Modal -->
<div id="petModal" class="modal">
  <div class="modal-content">
    <h3><i class="fas fa-paw"></i> Pet Details</h3>
    <div id="petDetails"></div>
    <button class="btn close-pet"><i class="fas fa-times"></i> Close</button>
  </div>
</div>

<!-- Family Member Details Modal -->
<div id="memberModal" class="modal">
  <div class="modal-content">
    <h3><i class="fas fa-user-friends"></i> Family Member Details</h3>
    <div id="memberDetails"></div>
    <button class="btn close-member"><i class="fas fa-times"></i> Close</button>
  </div>
</div>

<!-- Homeowner Details Modal -->
<div id="homeownerModal" class="modal">
  <div class="modal-content">
    <h3><i class="fas fa-home"></i> Homeowner Details</h3>
    <div id="homeownerDetails"></div>
    <button class="btn close-homeowner"><i class="fas fa-times"></i> Close</button>
  </div>
</div>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, query, where, onSnapshot, doc, updateDoc, getDoc, getDocs } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAidTEv40n7YXzDojKCP2WO9ifi-n-N1GY",
    authDomain: "evissa-e-community.firebaseapp.com",
    projectId: "evissa-e-community",
    storageBucket: "evissa-e-community.appspot.com",
    messagingSenderId: "407448688902",
    appId: "1:407448688902:web:4010dd5d57bc3103a56687",
    measurementId: "G-2N4HMXGSR1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  const accountsTableBody = document.querySelector("#accountsTable tbody");
  const tableHeadRow = document.getElementById("tableHeadRow");
  const accountsBtn = document.getElementById("accountsBtn");
  const pendingBtn = document.getElementById("pendingBtn");

  let unsubscribe = null;
  let currentUserRole = null;
  let currentUserId = null;

  // Check user authentication and role
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      try {
        const userDoc = await getDoc(doc(db, "users", user.uid));
        if (userDoc.exists()) {
          currentUserRole = userDoc.data().role_name;
          if (currentUserRole === 'admin') {
            loadAccounts(); // Load default view
          } else {
            alert("Access denied. Admin privileges required.");
            window.location.href = "dashboard.html";
          }
        }
      } catch (error) {
        console.error("Error checking user role:", error);
        showErrorState("Error loading user data");
      }
    } else {
      window.location.href = "login.html";
    }
  });

  // Helper function to show error state
  function showErrorState(message) {
    accountsTableBody.innerHTML = `<tr><td colspan="6" style="text-align:center;color:#ef4444;padding:40px"><i class="fas fa-exclamation-circle"></i><br>${message}</td></tr>`;
  }

  // Helper function to show empty state
  function showEmptyState(message, submessage = "") {
    accountsTableBody.innerHTML = `
      <tr>
        <td colspan="6">
          <div class="empty-state">
            <i class="fas fa-inbox"></i>
            <p>${message}</p>
            <div class="subtext">${submessage}</div>
          </div>
        </td>
      </tr>
    `;
  }

  // Helper function to show loading state
  function showLoadingState(columns) {
    let loadingHTML = "";
    for (let i = 0; i < 5; i++) {
      loadingHTML += `<tr class="loading-row">`;
      for (let j = 0; j < columns; j++) {
        loadingHTML += `<td><div class="loading-placeholder"></div></td>`;
      }
      loadingHTML += `</tr>`;
    }
    accountsTableBody.innerHTML = loadingHTML;
  }

  // Format block/lot to uppercase
  function formatBlockLot(block, lot) {
    let formattedBlock = block ? block.toUpperCase() : 'N/A';
    let formattedLot = lot ? lot.toUpperCase() : 'N/A';
    
    // Ensure BLK and LOT prefixes
    if (!formattedBlock.startsWith('BLK') && formattedBlock !== 'N/A') {
      formattedBlock = 'BLK ' + formattedBlock;
    }
    if (!formattedLot.startsWith('LOT') && formattedLot !== 'N/A') {
      formattedLot = 'LOT ' + formattedLot;
    }
    
    return `${formattedBlock} ${formattedLot}`;
  }

  // ✅ Load approved accounts (real-time)
  function loadAccounts() {
    if (unsubscribe) unsubscribe();
    tableHeadRow.innerHTML = `
      <th>Block/Lot</th>
      <th>Homeowner Name</th>
      <th>Actions</th>
    `;
    
    showLoadingState(3);

    const q = query(collection(db, "users"), where("status", "==", "approved"));
    unsubscribe = onSnapshot(q, (snapshot) => {
      accountsTableBody.innerHTML = "";
      if (snapshot.empty) {
        showEmptyState("No approved accounts found", "When users are approved, they will appear here");
        return;
      }
      snapshot.forEach((docSnap) => {
        const user = docSnap.data();
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>
            <a class="block-lot-link" onclick="showHomeownerDetails('${docSnap.id}')">
              <i class="fas fa-home"></i> ${formatBlockLot(user.block, user.lot)}
            </a>
          </td>
          <td>${user.firstname || ''} ${user.lastname || ''}</td>
          <td>
            <button onclick="showVehicles('${docSnap.id}')"><i class="fas fa-car"></i> Vehicles</button>
            <button onclick="showPets('${docSnap.id}')"><i class="fas fa-paw"></i> Pets</button>
            <button onclick="showMembers('${docSnap.id}')"><i class="fas fa-users"></i> Members</button>
          </td>
        `;
        accountsTableBody.appendChild(row);
      });
    }, (error) => {
      console.error("Error loading accounts:", error);
      showErrorState("Error loading data. Please try again.");
    });
  }

  // ✅ Load pending accounts (real-time)
  function loadPending() {
    if (unsubscribe) unsubscribe();
    tableHeadRow.innerHTML = `
      <th>Block/Lot</th>
      <th>Homeowner Name</th>
      <th>Email</th>
      <th>Status</th>
      <th>Actions</th>
    `;
    
    showLoadingState(5);

    const q = query(collection(db, "users"), where("status", "==", "pending"));
    unsubscribe = onSnapshot(q, (snapshot) => {
      accountsTableBody.innerHTML = "";
      if (snapshot.empty) {
        showEmptyState("No pending accounts", "All user applications have been processed");
        return;
      }
      snapshot.forEach((docSnap) => {
        const user = docSnap.data();
        const statusClass = user.status ? `status-${user.status.toLowerCase()}` : '';
        
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>
            <a class="block-lot-link" onclick="showHomeownerDetails('${docSnap.id}')">
              <i class="fas fa-home"></i> ${formatBlockLot(user.block, user.lot)}
            </a>
          </td>
          <td>${user.firstname || ''} ${user.lastname || ''}</td>
          <td>${user.email || ''}</td>
          <td class="${statusClass}">${user.status ? user.status.toUpperCase() : 'PENDING'}</td>
          <td>
            <button onclick="approveUser('${docSnap.id}')"><i class="fas fa-check"></i> Approve</button>
            <button onclick="declineUser('${docSnap.id}')"><i class="fas fa-times"></i> Decline</button>
          </td>
        `;
        accountsTableBody.appendChild(row);
      });
    }, (error) => {
      console.error("Error loading pending accounts:", error);
      showErrorState("Error loading data. Please try again.");
    });
  }

  // ✅ Show Homeowner Details
  window.showHomeownerDetails = async function(userId) {
    try {
      const userDoc = await getDoc(doc(db, "users", userId));
      if (userDoc.exists()) {
        const user = userDoc.data();
        const modal = document.getElementById("homeownerModal");
        const content = document.getElementById("homeownerDetails");
        
        // Format the created_at timestamp
        let createdAt = 'N/A';
        if (user.created_at && user.created_at.toDate) {
          createdAt = user.created_at.toDate().toLocaleString();
        }
        
        content.innerHTML = `
          <div class="detail-item">
            <p><b>Name:</b> ${user.firstname || ''} ${user.lastname || ''}</p>
            <p><b>Email:</b> ${user.email || 'N/A'}</p>
            <p><b>Contact No:</b> ${user.contactNo || 'N/A'}</p>
            <p><b>Birthdate:</b> ${user.bdate || 'N/A'}</p>
            <p><b>Block/Lot:</b> ${formatBlockLot(user.block, user.lot)}</p>
            <p><b>Role:</b> ${user.role_name || 'N/A'}</p>
            <p><b>Status:</b> <span class="status-${user.status || 'pending'}">${user.status ? user.status.toUpperCase() : 'PENDING'}</span></p>
            <p><b>Account Created:</b> ${createdAt}</p>
          </div>
        `;
        
        modal.style.display = "flex";
      }
    } catch (error) {
      console.error("Error loading homeowner details:", error);
      const content = document.getElementById("homeownerDetails");
      content.innerHTML = `<p style="color:#ef4444;"><i class="fas fa-exclamation-circle"></i> Error loading details: ${error.message}</p>`;
    }
  }

  // ✅ Show Vehicles
  window.showVehicles = async function(userId) {
    currentUserId = userId;
    const modal = document.getElementById("vehicleModal");
    const content = document.getElementById("vehicleDetails");
    
    content.innerHTML = "<p>Loading vehicles...</p>";
    modal.style.display = "flex";
    
    try {
      const vehiclesSnapshot = await getDocs(collection(db, "users", userId, "vehicle"));
      
      if (vehiclesSnapshot.empty) {
        content.innerHTML = "<div class='empty-state'><i class='fas fa-car'></i><p>No vehicles registered</p></div>";
        return;
      }
      
      let vehiclesHTML = "";
      vehiclesSnapshot.forEach(docSnap => {
        const vehicle = docSnap.data();
        const registerDate = vehicle.date_of_register?.toDate ? vehicle.date_of_register.toDate().toLocaleDateString() : 'N/A';
        
        vehiclesHTML += `
          <div class="detail-item">
            <p><b>Plate Number:</b> ${vehicle.plate_number || 'N/A'}</p>
            <p><b>Model:</b> ${vehicle.model || 'N/A'}</p>
            <p><b>Date Registered:</b> ${registerDate}</p>
            <hr>
          </div>
        `;
      });
      
      content.innerHTML = vehiclesHTML;
    } catch (error) {
      console.error("Error loading vehicles:", error);
      content.innerHTML = `<p style="color:#ef4444;"><i class="fas fa-exclamation-circle"></i> Error loading vehicles: ${error.message}</p>`;
    }
  }

  // ✅ Show Pets
  window.showPets = async function(userId) {
    currentUserId = userId;
    const modal = document.getElementById("petModal");
    const content = document.getElementById("petDetails");
    
    content.innerHTML = "<p>Loading pets...</p>";
    modal.style.display = "flex";
    
    try {
      const petsSnapshot = await getDocs(collection(db, "users", userId, "pets"));
      
      if (petsSnapshot.empty) {
        content.innerHTML = "<div class='empty-state'><i class='fas fa-paw'></i><p>No pets registered</p></div>";
        return;
      }
      
      let petsHTML = "";
      petsSnapshot.forEach(docSnap => {
        const pet = docSnap.data();
        
        petsHTML += `
          <div class="detail-item">
            <p><b>Name:</b> ${pet.name || 'N/A'}</p>
            <p><b>Species:</b> ${pet.species || 'N/A'}</p>
            <hr>
          </div>
        `;
      });
      
      content.innerHTML = petsHTML;
    } catch (error) {
      console.error("Error loading pets:", error);
      content.innerHTML = `<p style="color:#ef4444;"><i class="fas fa-exclamation-circle"></i> Error loading pets: ${error.message}</p>`;
    }
  }

  // ✅ Show Family Members
  window.showMembers = async function(userId) {
    currentUserId = userId;
    const modal = document.getElementById("memberModal");
    const content = document.getElementById("memberDetails");
    
    content.innerHTML = "<p>Loading family members...</p>";
    modal.style.display = "flex";
    
    try {
      const membersSnapshot = await getDocs(collection(db, "users", userId, "fam_members"));
      
      if (membersSnapshot.empty) {
        content.innerHTML = "<div class='empty-state'><i class='fas fa-users'></i><p>No family members registered</p></div>";
        return;
      }
      
      let membersHTML = "";
      membersSnapshot.forEach(docSnap => {
        const member = docSnap.data();
        
        membersHTML += `
          <div class="detail-item">
            <p><b>First Name:</b> ${member.First_Name || 'N/A'}</p>
            <p><b>Last Name:</b> ${member.Last_Name || 'N/A'}</p>
            <p><b>Relationship:</b> ${member.Relationship || 'N/A'}</p>
            <hr>
          </div>
        `;
      });
      
      content.innerHTML = membersHTML;
    } catch (error) {
      console.error("Error loading family members:", error);
      content.innerHTML = `<p style="color:#ef4444;"><i class="fas fa-exclamation-circle"></i> Error loading family members: ${error.message}</p>`;
    }
  }

  // ✅ Approve user
  window.approveUser = async function(userId) {
    if (confirm("Are you sure you want to approve this user?")) {
      try {
        await updateDoc(doc(db, "users", userId), { status: "approved" });
        alert("User approved successfully!");
      } catch (error) {
        console.error("Error approving user:", error);
        alert("Error approving user. Please try again.");
      }
    }
  }

  // ✅ Decline user
  window.declineUser = async function(userId) {
    if (confirm("Are you sure you want to decline this user?")) {
      try {
        await updateDoc(doc(db, "users", userId), { status: "declined" });
        alert("User declined successfully!");
      } catch (error) {
        console.error("Error declining user:", error);
        alert("Error declining user. Please try again.");
      }
    }
  }

  // Tab switching
  accountsBtn.addEventListener("click", () => {
    if (currentUserRole !== 'admin') return;
    accountsBtn.classList.add("active");
    pendingBtn.classList.remove("active");
    loadAccounts();
  });

  pendingBtn.addEventListener("click", () => {
    if (currentUserRole !== 'admin') return;
    pendingBtn.classList.add("active");
    accountsBtn.classList.remove("active");
    loadPending();
  });

  // Close modal functionality
  document.querySelector(".close-vehicle").addEventListener("click", () => {
    document.getElementById("vehicleModal").style.display = "none";
  });

  document.querySelector(".close-pet").addEventListener("click", () => {
    document.getElementById("petModal").style.display = "none";
  });

  document.querySelector(".close-member").addEventListener("click", () => {
    document.getElementById("memberModal").style.display = "none";
  });

  document.querySelector(".close-homeowner").addEventListener("click", () => {
    document.getElementById("homeownerModal").style.display = "none";
  });

  // Close modals if clicked outside
  window.addEventListener("click", (e) => {
    if (e.target === document.getElementById("vehicleModal")) {
      document.getElementById("vehicleModal").style.display = "none";
    }
    if (e.target === document.getElementById("petModal")) {
      document.getElementById("petModal").style.display = "none";
    }
    if (e.target === document.getElementById("memberModal")) {
      document.getElementById("memberModal").style.display = "none";
    }
    if (e.target === document.getElementById("homeownerModal")) {
      document.getElementById("homeownerModal").style.display = "none";
    }
  });
</script>

</body>
</html>